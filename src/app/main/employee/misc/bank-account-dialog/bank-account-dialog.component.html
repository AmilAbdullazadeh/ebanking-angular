<div *ngIf="account">
    <mat-toolbar>Edycja rachunku bankowego <button class="ml-auto" *ngIf="!account.removed" type="button" (click)="deleteBankAccount()" mat-raised-button color="warn">Usuń</button>
    </mat-toolbar>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <mat-form-field>
                    <input matInput placeholder="Rachunek bankowy" type="text" [(ngModel)]="account.number">
                </mat-form-field>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6" *ngFor="let saldo of account.saldos">
                <mat-form-field>
                    <input matInput placeholder="{{saldo.currencyType.name}}" type="text" [(ngModel)]="saldo.balance">
                </mat-form-field>
            </div>
        </div>
        <mat-toolbar>Aktywne kredyty</mat-toolbar>
        <div class="row">
            <div *ngIf="credits?.length === 0">Brak aktywnych kredytów</div>
            <table *ngIf="credits?.length > 0" mat-table [dataSource]="credits">

                <ng-container matColumnDef="ID">
                    <th mat-header-cell *matHeaderCellDef>ID</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.id}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="installmentAmount">
                    <th mat-header-cell *matHeaderCellDef>Spłacono</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.installmentAmount }}
                    </td>
                </ng-container>


                <ng-container matColumnDef="details">
                    <th mat-header-cell *matHeaderCellDef>Wysokość</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.totalBalance }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef>Status</th>
                    <td mat-cell *matCellDef="let element">
                        <span *ngIf="element.creditStatus.creditType === 'ACTIVE'">Aktywny</span>
                        <span *ngIf="element.creditStatus.creditType === 'AWAITING'">Oczekujący</span>
                        <span *ngIf="element.creditStatus.creditType === 'CANCELED'">Usunięty</span>
                        <span *ngIf="element.creditStatus.creditType === 'PAID'">Spłacony</span>
                    </td>
                </ng-container>

                <ng-container matColumnDef="changeStatus">
                    <th mat-header-cell *matHeaderCellDef>Zmień status</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-raised-button class="bg-primary text-white"
                            (click)="changeCreditStatus(element.id)">Zmień</button>
                    </td>
                </ng-container>

                <tr mat-header-row
                    *matHeaderRowDef="[ 'ID', 'installmentAmount', 'details', 'status', 'changeStatus']; sticky: true">
                </tr>
                <tr mat-row
                    *matRowDef="let row; columns: [ 'ID', 'installmentAmount', 'details', 'status', 'changeStatus'];">
                </tr>
            </table>
        </div>
        <mat-toolbar>Aktywne lokaty</mat-toolbar>
        <div class="row">
            <div *ngIf="investments?.length === 0">Brak aktywnych lokat</div>
            <table *ngIf="investments?.length > 0" mat-table [dataSource]="investments">

                <ng-container matColumnDef="ID">
                    <th mat-header-cell *matHeaderCellDef>ID</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.id}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="startBalance">
                    <th mat-header-cell *matHeaderCellDef>Kwota początkowa</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.startBalance }}
                    </td>
                </ng-container>


                <ng-container matColumnDef="currentBalance">
                    <th mat-header-cell *matHeaderCellDef>Kwota obecna</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.currentBalance }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="creationDate">
                    <th mat-header-cell *matHeaderCellDef>Data utworzenia</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.creationDate | amDateFormat: 'LL HH:mm'}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="changeStatus">
                    <th mat-header-cell *matHeaderCellDef>Zmień status</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-raised-button class="bg-primary text-white"
                            (click)="changeInvestmentStatus(element.id)">Zmień</button>
                    </td>
                </ng-container>

                <tr mat-header-row
                    *matHeaderRowDef="[ 'ID', 'startBalance', 'currentBalance', 'creationDate', 'changeStatus']; sticky: true">
                </tr>
                <tr mat-row
                    *matRowDef="let row; columns: [ 'ID', 'startBalance', 'currentBalance', 'creationDate', 'changeStatus'];">
                </tr>
            </table>
        </div>
    </div>
    <div mat-dialog-actions align="center">
        <button mat-button [mat-dialog-close]="account" cdkFocusInitial>Zapisz</button>
        <button mat-button (click)="onNoClick()">Anuluj</button>
    </div>
</div>